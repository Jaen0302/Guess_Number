<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Guess the Number</title>
  <meta name="color-scheme" content="light dark" />
  <style>
    :root {
      --bg1: #0ea5e9;
      --bg2: #8b5cf6;
      --card: rgba(255,255,255,.9);
      --text: #111827;
      --muted: #6b7280;
      --accent: #2563eb;
      --accent-2: #06b6d4;
      --good: #16a34a;
      --bad: #dc2626;
      --warning: #f59e0b;
      --radius: 16px;
      --shadow: 0 10px 30px rgba(0,0,0,.15);
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --card: rgba(17, 24, 39, .85);
        --text: #e5e7eb;
        --muted: #9ca3af;
        --accent: #60a5fa;
        --accent-2: #22d3ee;
        --shadow: 0 10px 30px rgba(0,0,0,.5);
      }
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color: var(--text);
      background: radial-gradient(1200px 800px at 10% -10%, var(--bg1), transparent 60%),
                  radial-gradient(1200px 800px at 110% 10%, var(--bg2), transparent 60%),
                  linear-gradient(120deg, #0ea5e92a, #8b5cf62a);
      background-attachment: fixed;
      display: grid;
      place-items: center;
      padding: 24px;
    }
    .card {
      width: 100%;
      max-width: 680px;
      background: var(--card);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 28px 28px 22px;
      position: relative;
      overflow: hidden;
    }
    .card:before {
      content: "";
      position: absolute;
      inset: -2px;
      border-radius: inherit;
      padding: 2px;
      background: linear-gradient(120deg, var(--accent), var(--accent-2));
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
              mask-composite: exclude;
      pointer-events: none;
      opacity: .35;
    }
    header h1 {
      margin: 0 0 6px;
      font-size: clamp(24px, 3vw, 32px);
      letter-spacing: .2px;
    }
    .lead { margin: 0 0 16px; color: var(--muted); }
    .row {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      margin: 14px 0 6px;
    }
    input[type="number"] {
      padding: 12px 14px;
      font-size: 18px;
      border: 1px solid #d1d5db;
      border-radius: 12px;
      outline: none;
      transition: box-shadow .2s, border-color .2s;
      background: #fff;
      color: #111827;
    }
    input[type="number"]:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 4px color-mix(in oklab, var(--accent) 20%, transparent);
    }
    @media (prefers-color-scheme: dark) {
      input[type="number"] { background: #0b1220; color: #e5e7eb; border-color: #374151; }
    }
    button {
      padding: 12px 16px;
      font-size: 16px;
      border: 0;
      border-radius: 12px;
      cursor: pointer;
      transition: transform .05s ease, box-shadow .2s ease, background .2s;
      white-space: nowrap;
    }
    button:active { transform: translateY(1px); }
    .primary { background: linear-gradient(120deg, var(--accent), var(--accent-2)); color: #fff; box-shadow: 0 6px 16px rgba(37,99,235,.35); }
    button:disabled, input:disabled { opacity: .6; cursor: not-allowed; }
    .hint {
      min-height: 28px;
      margin-top: 12px;
      font-weight: 650;
      letter-spacing: .2px;
    }
    .hint.pop { animation: pop .25s ease; }
    @keyframes pop { 0% { transform: scale(.98); opacity: .5; } 100% { transform: scale(1); opacity: 1; } }
    .meta { margin-top: 8px; color: var(--muted); font-size: 14px; display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
    .tries { display: inline-flex; gap: 6px; --size: 12px; }
    .dot { width: var(--size); height: var(--size); border-radius: 999px; background: #e5e7eb; }
    .dot.used { background: #fca5a5; }
    .dot.left { background: #a7f3d0; }
    .progress { position: relative; width: 100%; height: 8px; background: #e5e7eb; border-radius: 999px; overflow: hidden; margin-top: 14px; }
    .bar { position: absolute; left: 0; top: 0; bottom: 0; width: 0%; background: linear-gradient(90deg, var(--accent), var(--accent-2)); transition: width .3s ease; }
    footer { margin-top: 18px; font-size: 12px; color: var(--muted); }

    /* --- History styles (lightweight, matches your card) --- */
    .history {
      margin-top: 14px;
      border-top: 1px dashed rgba(0,0,0,.12);
      padding-top: 12px;
    }
    @media (prefers-color-scheme: dark) {
      .history { border-top-color: rgba(255,255,255,.18); }
    }
    .history h2 {
      margin: 0 0 8px;
      font-size: 14px;
      color: var(--muted);
      font-weight: 600;
      letter-spacing: .2px;
    }
    .history-list {
      display: grid;
      grid-template-columns: 56px 1fr 1fr;
      gap: 8px 12px;
      align-items: center;
      font-size: 14px;
    }
    .history-list .hdr {
      color: var(--muted);
      font-weight: 600;
    }
    .pill-mini {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 12px;
      line-height: 1;
      color: #fff;
    }
    .pill-high { background: var(--accent); }
    .pill-low { background: var(--accent-2); }
    .pill-correct { background: var(--good); }
  </style>
</head>
<body>
  <div class="card" role="main" aria-labelledby="title">
    <header>
      <h1 id="title">Guess the Number</h1>
      <p class="lead">I picked a number between <strong>0</strong> and <strong>100</strong>. You have <strong>5</strong> tries.</p>
    </header>

    <div class="row">
      <label for="guess" class="sr-only" style="position:absolute;left:-10000px;">Enter your guess</label>
      <input id="guess" type="number" min="0" max="100" placeholder="Enter 0–100" inputmode="numeric" />
      <button id="btn-guess" class="primary" title="Submit your guess">Guess</button>
    </div>

    <div class="hint" id="hint" aria-live="polite"></div>

    <div class="meta">
      <span id="status">New round. Good luck!</span>
      <span class="tries" id="tries" aria-label="Tries indicator"></span>
    </div>

    <div class="progress" aria-hidden="true">
      <div class="bar" id="bar"></div>
    </div>

    <!-- New: Previous guesses -->
    <section class="history" aria-live="polite" aria-label="Previous guesses">
      <h2>Previous guesses</h2>
      <div class="history-list" id="historyList">
        <div class="hdr">Try</div>
        <div class="hdr">Guess</div>
        <div class="hdr">Result</div>
        <!-- rows injected here -->
      </div>
    </section>

    <footer>Tip: Press <kbd>Enter</kbd> to submit your guess.</footer>
  </div>

  <canvas class="confetti" id="confetti" width="0" height="0"></canvas>

  <script>
    (() => {
      const SECRET = 52; // fixed number
      const MAX_TRIES = 5;
      let tries = 0;
      const history = []; // {n, guess, result: 'Higher'|'Lower'|'Correct'}

      const $ = (id) => document.getElementById(id);
      const input = $('guess');
      const btnGuess = $('btn-guess');
      const hint = $('hint');
      const status = $('status');
      const triesBox = $('tries');
      const bar = $('bar');
      const historyList = $('historyList');

      function renderDots() {
        triesBox.innerHTML = '';
        for (let i = 0; i < MAX_TRIES; i++) {
          const d = document.createElement('span');
          d.className = 'dot ' + (i < tries ? 'used' : 'left');
          triesBox.appendChild(d);
        }
      }

      function setBar() {
        const usedRatio = Math.min(tries / MAX_TRIES, 1);
        bar.style.width = (usedRatio * 100) + '%';
      }

      function popHint(text, color) {
        hint.textContent = text;
        hint.style.color = color || 'inherit';
        hint.classList.remove('pop');
        void hint.offsetWidth;
        hint.classList.add('pop');
      }

      function addHistoryRow(n, guess, result) {
        // row: Try#, Guess value, Result pill
        const tryEl = document.createElement('div');
        tryEl.textContent = n;

        const guessEl = document.createElement('div');
        guessEl.textContent = guess;

        const resEl = document.createElement('div');
        const pill = document.createElement('span');
        pill.className = 'pill-mini ' + (
          result === 'Correct' ? 'pill-correct' :
          result === 'Higher'  ? 'pill-high' :
                                 'pill-low'
        );
        pill.textContent = result;
        resEl.appendChild(pill);

        historyList.appendChild(tryEl);
        historyList.appendChild(guessEl);
        historyList.appendChild(resEl);
      }

      function renderHistory() {
        // Clear rows but keep headers (first 3 children)
        while (historyList.children.length > 3) {
          historyList.removeChild(historyList.lastChild);
        }
        history.forEach(item => addHistoryRow(item.n, item.guess, item.result));
      }

      function endGame(win) {
        input.disabled = true;
        btnGuess.disabled = true;
        status.textContent = win ? 'You got it! 🎉' : 'No chances left.';
        if (win) fireConfetti();
      }

      function check() {
        if (input.disabled) return;
        const v = Number(input.value);
        if (!Number.isInteger(v) || v < 0 || v > 100) {
          popHint('Please enter a whole number between 0 and 100.', 'var(--warning)');
          return;
        }

        tries += 1;
        renderDots();
        setBar();

        if (v === SECRET) {
          popHint('🎉 Correct! The number is 52.', 'var(--good)');
          status.textContent = `Attempts used: ${tries}`;
          history.push({ n: tries, guess: v, result: 'Correct' });
          renderHistory();
          endGame(true);
          return;
        }

        const left = MAX_TRIES - tries;
        const relation = v < SECRET ? 'Higher' : 'Lower';
        popHint(v < SECRET ? 'Too low — guess higher.' : 'Too high — guess lower.', 'var(--accent)');
        status.textContent = left === 1 ? 'Last chance!' : `Chances left: ${left}`;
        history.push({ n: tries, guess: v, result: relation });
        renderHistory();

        if (left === 0) {
          popHint('❌ Wrong! You failed. The number was 52.', 'var(--bad)');
          endGame(false);
          return;
        }

        input.select();
      }

      btnGuess.addEventListener('click', check);
      input.addEventListener('keydown', (e) => { if (e.key === 'Enter') check(); });

      // Confetti
      const canvas = document.getElementById('confetti');
      const ctx = canvas.getContext('2d');
      let confettiPieces = [];
      let raf = null;
      function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
      window.addEventListener('resize', resize);
      resize();
      function fireConfetti() {
        confettiPieces = Array.from({ length: 120 }, () => ({
          x: Math.random() * canvas.width,
          y: -20 - Math.random() * canvas.height * 0.3,
          w: 6 + Math.random() * 6,
          h: 8 + Math.random() * 10,
          vy: 2 + Math.random() * 3,
          vx: -1 + Math.random() * 2,
          rot: Math.random() * Math.PI,
          vr: -0.2 + Math.random() * 0.4,
          hue: Math.floor(200 + Math.random() * 100)
        }));
        cancelAnimationFrame(raf);
        tick();
      }
      function tick() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        confettiPieces.forEach(p => {
          p.x += p.vx; p.y += p.vy; p.rot += p.vr;
          if (p.y > canvas.height + 20) p.y = -20;
          ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.rot);
          ctx.fillStyle = `hsl(${p.hue} 90% 55%)`;
          ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
          ctx.restore();
        });
        raf = requestAnimationFrame(tick);
      }

      // boot
      renderDots();
      setBar();
    })();
  </script>
</body>
</html>
